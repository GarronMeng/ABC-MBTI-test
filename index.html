<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABCerä¸“å±MBTIæµ‹è¯•</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background-color: #F0F0FF; /* æµ…è“è‰²èƒŒæ™¯ */
            color: #0000AA; /* æ·±è“è‰²æ–‡å­— */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 100%;
        }
        .header { text-align: center; margin-bottom: 20px; }
        .question-text { font-size: 1.2rem; font-weight: bold; margin-bottom: 20px; line-height: 1.5; color: #0000AA; }
        .options { display: flex; flex-direction: column; gap: 12px; }
        .option-btn {
            background: #E6E6FF; /* æµ…è“è‰²é€‰é¡¹èƒŒæ™¯ */
            border: 2px solid transparent;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            font-size: 1rem;
            transition: all 0.2s;
            color: #0000AA;
        }
        .option-btn:hover { background: #D0D0FF; border-color: #0000AA; }
        .nav-btn {
            margin-top: 20px; background: transparent; color: #666; border: none;
            cursor: pointer; text-decoration: underline; padding: 0; font-size: 0.9rem; display: none;
        }
        .result-title { color: #0000AA; font-size: 1.5rem; text-align: center; margin-bottom: 15px; }
        .result-desc { font-size: 1rem; line-height: 1.6; color: #475569; }
        .restart-btn {
            display: block; width: 100%; background: #FFFF00; /* é»„è‰²èƒŒæ™¯ */
            color: #0000AA; /* æ·±è“è‰²æ–‡å­— */
            border: none; padding: 12px; border-radius: 8px; margin-top: 20px; cursor: pointer; font-size: 1rem; text-align: center;
        }
        .restart-btn:hover { background-color: #E6E600; }
        .generate-btn {
            display: block; width: 100%; background: #0000AA; /* æ·±è“è‰²èƒŒæ™¯ */
            color: #FFFF00; /* é»„è‰²æ–‡å­— */
            border: none; padding: 12px; border-radius: 8px; margin-top: 20px; cursor: pointer; font-size: 1rem; text-align: center;
        }
        .generate-btn:hover { background-color: #000088; }
        /* ä¸ºæµ·æŠ¥ç”Ÿæˆçš„ç‰¹å®šå®¹å™¨å¢åŠ æ ·å¼ */
        #poster-container {
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            margin: -20px; /* æŠµæ¶ˆå¤–å±‚ paddingï¼Œä½¿æˆªå›¾æ›´ç´§å‡‘ */
        }
    </style>
</head>
<body>

<div class="container">
    <div id="intro-screen">
        <div class="header">
            <img src="image_0.png" alt="ABC Logo" style="max-width: 150px; margin-bottom: 10px;">
            <h2>ğŸŒŸã€ABCerä¸“å±MBTIã€‘</h2>
            <p>7ç§ABCerï¼Œä½ æ˜¯å“ªä¸€ç§ï¼Ÿ</p>
        </div>
        <p style="color: #666; font-size: 0.95rem; line-height: 1.5;">å˜¿ï¼æ¥ABCç¾å¥½ç¤¾ä¼šå’¨è¯¢ç¤¾çš„å°ä¼™ä¼´ä»¬ï¼Œæ¯ä¸ªäººéƒ½å¸¦ç€ä¸åŒçš„æ•…äº‹å’ŒæœŸå¾…ï½ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸ºä½ é‡èº«å®šåˆ¶äº†ä¸€å¥—ä¸“å±äººæ ¼æµ‹è¯•ï¼10é“é¢˜ï¼Œæµ‹å‡ºä½ åœ¨å…¬ç›Šå’¨è¯¢ä¸­çš„çœŸå®ç”»åƒã€‚</p>
        <button class="restart-btn" onclick="startTest()">å¼€å§‹æµ‹è¯•</button>
    </div>

    <div id="question-screen" style="display: none;">
        <div class="question-text" id="q-text"></div>
        <div class="options" id="q-options"></div>
        <button class="nav-btn" id="back-btn" onclick="goBack()">â† è¿”å›ä¸Šä¸€é¢˜</button>
    </div>

    <div id="result-screen" style="display: none;">
        <div id="poster-container">
            <h2 class="result-title" id="r-title"></h2>
            <div class="result-desc" id="r-desc"></div>
        </div>
        
        <div id="final-image-container" style="display: none; text-align: center;">
            <p style="color: #0000AA; font-weight: bold; margin-bottom: 15px;">â¬‡ï¸ é•¿æŒ‰ä¸‹æ–¹å›¾ç‰‡ä¿å­˜å¹¶åˆ†äº« â¬‡ï¸</p>
            <img id="final-poster-img" style="width: 100%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);" />
        </div>

        <button id="btn-generate" class="generate-btn" onclick="generatePoster()">ğŸ“¸ ç”Ÿæˆä¸“å±æµ·æŠ¥</button>
        <button class="restart-btn" onclick="resetTest()">é‡æ–°æµ‹è¯•</button>
    </div>
</div>

<script>
    // é—®å·é€»è¾‘æ•°æ®æ¨¡å‹ (å®Œæ•´ä¿ç•™)
    const quizData = {
        Q1: { text: "Q1. éš¾å¾—çš„å‘¨æœ«ç©ºé—²ï¼Œä½ æœ€æƒ³æ€ä¹ˆåº¦è¿‡ï¼Ÿ", options: [{text:"A. çº¦æœ‹å‹æ¢åº—çœ‹å±•ï¼Œè§£é”æ–°ä½“éªŒ",target:"Q2"},{text:"B. å‚åŠ è¡Œä¸šæ²™é¾™ï¼Œå¬å¬å‰æ²¿åˆ†äº«",target:"Q3"},{text:"C. æ‰¾ä¸ªå’–å•¡é¦†ï¼Œå®‰å®‰é™é™çœ‹ä¹¦",target:"Q4"},{text:"D. çº¦ä¸‰äº”å¥½å‹ï¼ŒèŠèŠè¿‘å†µå’Œå¿ƒäº‹",target:"Q5"}] },
        Q2: { text: "Q2. ä½ æ›´å‘å¾€å“ªç§å›¢é˜Ÿæ°›å›´ï¼Ÿ", options: [{text:"A. æœ‰å‰è¾ˆå¸¦ç€ï¼Œèƒ½å­¦åˆ°å¾ˆå¤šä¸œè¥¿",target:"R_1"},{text:"B. å¤§å®¶å„æœ‰æ‰€é•¿ï¼Œé«˜æ•ˆåä½œæ‰“ç¡¬ä»—",target:"Q6"},{text:"C. æ¸©æš–åŒ…å®¹ï¼Œå¯ä»¥å¸ä¸‹é˜²å¤‡åšè‡ªå·±",target:"Q7"},{text:"D. å¼€æ”¾è‡ªç”±ï¼Œå…è®¸å¤©é©¬è¡Œç©ºçš„è„‘æ´",target:"Q8"}] },
        Q3: { text: "Q3. ä½ å¯¹â€œå…¬ç›Šâ€çš„ç¬¬ä¸€å°è±¡æ˜¯ï¼Ÿ", options: [{text:"A. ä¸€ä¸ªèƒ½è®©ä¸“ä¸šå‘æŒ¥æ›´å¤§ä»·å€¼çš„åœ°æ–¹",target:"R_2"},{text:"B. ä¸€ä¸ªå¯ä»¥æ·±å…¥äº†è§£å…¬ç›Šç”Ÿæ€çš„æœºä¼š",target:"Q6"},{text:"C. ä¸€ä¸ªèƒ½è®©å¿ƒæ…¢ä¸‹æ¥ã€æš–èµ·æ¥çš„åœ°æ–¹",target:"Q7"},{text:"D. ä¸€ä¸ªå¯ä»¥æ¢ç´¢äººç”Ÿæ–°å¯èƒ½çš„å®éªŒåœº",target:"Q8"}] },
        Q4: { text: "Q4. ä½ æœ€è¿‘çš„çŠ¶æ€ï¼Œæ›´åƒå“ªä¸€å¥ï¼Ÿ", options: [{text:"A. ä¸–ç•Œé‚£ä¹ˆå¤§ï¼Œæˆ‘æƒ³å»è¯•è¯•",target:"R_3"},{text:"B. ç”¨ä¸“ä¸šï¼Œåšç‚¹æœ‰æ„ä¹‰çš„äº‹",target:"Q6"},{text:"C. åœ¨ç–²æƒ«çš„ç”Ÿæ´»é‡Œï¼Œæ‰¾ä¸€ç‚¹æ¸©æŸ”çš„å…‰",target:"Q7"},{text:"D. äººç”Ÿæ˜¯ä¸€åœºå®éªŒï¼Œç­”æ¡ˆåœ¨è·¯ä¸Š",target:"Q8"}] },
        Q5: { text: "Q5. ä½ æ›´æ„¿æ„å’Œä»€ä¹ˆæ ·çš„ä¼™ä¼´å…±äº‹ï¼Ÿ", options: [{text:"A. æ„¿æ„æ•™æˆ‘ã€å¸¦æˆ‘æˆé•¿çš„äºº",target:"R_1"},{text:"B. ä¸“ä¸šèƒ½åŠ›å¼ºã€èƒ½æ‰“ç¡¬ä»—çš„äºº",target:"Q6"},{text:"C. çœŸè¯šæ¸©æš–ã€å¯ä»¥äº¤å¿ƒçš„äºº",target:"R_4"},{text:"D. è„‘æ´å¤§ã€æ•¢æƒ³æ•¢è¯•çš„äºº",target:"Q8"}] },
        Q6: { text: "Q6. ä½ å¸Œæœ›ç”¨ä¸“ä¸šç»éªŒåœ¨å…¬ç›Šé¢†åŸŸåšä»€ä¹ˆï¼Ÿ", options: [{text:"A. æŠŠæŠ€èƒ½ç”¨åœ¨æ›´çœŸå®ã€æœ‰æ„ä¹‰çš„åœºæ™¯",target:"R_2"},{text:"B. è·³å‡ºå•ä¸€é¢†åŸŸï¼Œçœ‹è§æ›´å¤§çš„å…¬ç›Šç”Ÿæ€",target:"R_5"},{text:"C. å¸¦å›¢é˜Ÿè¯•è¯•ä¸ä¸€æ ·çš„è·¯ï¼Œç©ç‚¹æ–°çš„",target:"R_6"},{text:"D. æ—¢æƒ³è´¡çŒ®ä»·å€¼ï¼Œä¹Ÿæƒ³æ‰¾åˆ°å¹¶è‚©çš„ä¼™ä¼´",target:"Q9"}] },
        Q7: { text: "Q7. ä½ å¯»æ‰¾çš„â€œå¿ƒçš„å‡ºå£â€ï¼Œæ›´åƒå“ªä¸€ç§ï¼Ÿ", options: [{text:"A. ç”¨è¡ŒåŠ¨æ‰¾å›åˆå¿ƒï¼Œä¸å†è¢«ç–²æƒ«å¡«æ»¡",target:"R_4"},{text:"B. å’ŒçœŸè¯šçš„äººå»ºç«‹è¿æ¥ï¼Œäº’ç›¸æ¸©æš–",target:"R_4"},{text:"C. åœ¨å¸®åŠ©åˆ«äººçš„åŒæ—¶ï¼Œé‡æ–°è®¤è¯†è‡ªå·±",target:"Q10"},{text:"D. æƒ³ç”¨æ–°æ–¹å¼ç†è§£ä¸–ç•Œå’Œè‡ªå·±",target:"R_7"}] },
        Q8: { text: "Q8. ä½ æƒ³å°è¯•çš„â€œæ–°å¯èƒ½â€ï¼Œæ›´æ¥è¿‘ï¼Ÿ", options: [{text:"A. æŠŠå…´è¶£ã€ä¸“ä¸šå’Œç¤¾ä¼šè®®é¢˜è¿æ¥èµ·æ¥",target:"R_3"},{text:"B. ç”¨ç»éªŒå­µåŒ–åˆ›æ–°ï¼Œå¸¦å‡ºæ–°çš„å¯èƒ½",target:"R_6"},{text:"C. é‡æ–°æ„å»ºè‡ªå·±çš„ä¸–ç•Œè§‚å’Œäººç”Ÿæ¨¡å‹",target:"R_7"},{text:"D. éªŒè¯â€œæˆ‘é€‚ä¸é€‚åˆåšè¿™ç±»äº‹â€",target:"R_3"}] },
        Q9: { text: "Q9. ä½ å¸Œæœ›ä»ABCå¸¦èµ°çš„æ˜¯ä»€ä¹ˆï¼Ÿ", options: [{text:"A. ä¸€ä¸ªæœ‰å½±å“åŠ›çš„å®æˆ˜æ¡ˆä¾‹",target:"R_2"},{text:"B. å¯¹å…¬ç›Šç”Ÿæ€æ›´æ•´ä½“çš„ç†è§£",target:"R_5"},{text:"C. ä¸€æ¬¡ç”¨ç»éªŒåˆ›é€ æ–°å¯èƒ½çš„å°è¯•",target:"R_6"},{text:"D. ä¸€ç¾¤å¿—åŒé“åˆçš„æˆ˜å‹",target:"R_2"}] },
        Q10: { text: "Q10. ä½ æœŸå¾…åœ¨å…¬ç›Šä¸­é‡è§ä»€ä¹ˆï¼Ÿ", options: [{text:"A. ä¸€æ®µæ¸©æš–æœ‰åŠ›é‡çš„è®°å¿†",target:"R_4"},{text:"B. ä¸€æ¬¡é‡æ–°ä¸å†…å¿ƒå¯¹è¯çš„æ—…ç¨‹",target:"R_4"},{text:"C. ä¸€ç§å…¨æ–°çš„æ€ç»´æ–¹å¼",target:"R_7"},{text:"D. ä¸€ä¸ªé‡æ–°å®šä¹‰äººç”Ÿçš„å¥‘æœº",target:"R_7"}] }
    };

    // ç»“æœåº“æ•°æ® (å®Œæ•´ä¿ç•™)
    const resultsData = {
        R_1: { title: "å°è¯•é”‹èŠ’çš„æ–°é²œäºº", image: "r1.jpg", quote: "â€œä¸–ç•Œé‚£ä¹ˆå¤§ï¼Œæˆ‘æƒ³å»è¯•è¯•â€", description: "ä½ æ˜¯å¸¦ç€å¥½å¥‡å¿ƒå’Œå‹‡æ°”è¸å…¥å…¬ç›Šå’¨è¯¢ä¸–ç•Œçš„â€œå®è·µæ´¾ç©å®¶â€ã€‚åœ¨æ ¡å›­é‡Œç§¯ç´¯äº†çŸ¥è¯†ï¼Œæƒ³åœ¨çœŸå®ä¸–ç•Œé‡Œè·‘ä¸€æ¬¡â€œå‰¯æœ¬â€ã€‚ä½ æ¸´æœ›ç»“è¯†æœ‰è¶£çš„äººï¼Œç§¯ç´¯ç¬¬ä¸€ä»½é¡¹ç›®ç»éªŒï¼Œè¯•ç€æŠŠå…´è¶£ã€ä¸“ä¸šå’Œç¤¾ä¼šè®®é¢˜è¿æ¥èµ·æ¥ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€ä»½æ‰å®çš„é¡¹ç›®ç»å†ï¼Œä¸€ç¾¤æ„¿æ„å¸¦ä½ çš„å‰è¾ˆï¼Œä¸€æ¬¡æŠŠå¥½å¥‡å¿ƒå˜æˆè¡ŒåŠ¨åŠ›çš„æœºä¼šã€‚ä½ ä¼šå‘ç°ï¼Œä¸–ç•Œå¾ˆå¤§ï¼Œè€Œä½ ä¹Ÿå¯ä»¥æˆä¸ºæ”¹å˜çš„ä¸€éƒ¨åˆ†ã€‚" },
        R_2: { title: "ä¸“ä¸šä»·å€¼æ´¾", image: "r2.jpg", quote: "â€œç”¨ä¸“ä¸šï¼Œåšç‚¹æœ‰æ„ä¹‰çš„äº‹â€", description: "ä½ æ‹¥æœ‰è¾ƒå¼ºçš„ä¸“ä¸šèƒŒæ™¯ï¼ŒæœŸå¾…æŠŠè‡ªå·±çš„æŠ€èƒ½ç”¨äºæ›´çœŸå®ã€æ›´æœ‰æ„ä¹‰çš„åœºæ™¯ã€‚åœ¨é¡¹ç›®ä¸­å¸Œæœ›æ—¢èƒ½è´¡çŒ®ä»·å€¼ï¼Œä¹Ÿèƒ½æ‰¾åˆ°èƒ½å¤Ÿå¹¶è‚©ä½œæˆ˜çš„ä¼™ä¼´ï¼Œä¸€èµ·æŠŠäº‹æƒ…åšæˆã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€ä¸ªæœ‰å½±å“åŠ›çš„æ¡ˆä¾‹ï¼Œä¸€ç¾¤å¿—åŒé“åˆçš„æˆ˜å‹ï¼Œä¸€æ¬¡ä¸“ä¸šä¸å…¬ç›Šæ·±åº¦èåˆçš„å®è·µã€‚ä½ ä¼šå‘ç°ï¼Œä½ çš„æŠ€èƒ½å¯ä»¥ç‚¹äº®åˆ«äººï¼Œä¹Ÿå¯ä»¥ç…§äº®è‡ªå·±ã€‚" },
        R_3: { title: "ç†æƒ³è¯•æ¢è€…", image: "r3.jpg", quote: "â€œæˆ‘æƒ³çœ‹çœ‹ï¼Œæˆ‘é€‚ä¸é€‚åˆâ€", description: "ä½ åˆšè¸å…¥èŒåœºï¼Œæ¸´æœ›æ¢ç´¢æ›´å¤šå¯èƒ½æ€§ã€‚å¯¹å…¬å…±è®®é¢˜æœ‰å…´è¶£ï¼Œå´è¿˜ä¸ç¡®å®šæ–¹å‘ã€‚å¸Œæœ›é€šè¿‡ä¸€æ¬¡å…¬ç›Šå’¨è¯¢ï¼Œç§¯ç´¯æ¡ˆä¾‹ã€å¢å¼ºèŒä¸šæ„ŸçŸ¥ï¼Œä¹ŸéªŒè¯â€œæˆ‘é€‚ä¸é€‚åˆåšè¿™ç±»äº‹â€ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€æ¬¡ä½æˆæœ¬çš„èŒä¸šè¯•é”™æœºä¼šï¼Œä¸€ä¸ªéªŒè¯å…´è¶£ä¸èƒ½åŠ›çš„çœŸå®åœºæ™¯ï¼Œä¸€ç¾¤å¸®ä½ æ‰“å¼€è§†é‡çš„åŒè¡Œè€…ã€‚ä½ ä¼šå‘ç°ï¼Œç­”æ¡ˆä¸åœ¨åˆ«å¤„ï¼Œå°±åœ¨è¡ŒåŠ¨çš„è·¯ä¸Šã€‚" },
        R_4: { title: "å¿ƒç†é“¾æ¥è¿½å¯»è€…", image: "r4.jpg", quote: "â€œåœ¨ç–²æƒ«çš„ç”Ÿæ´»é‡Œï¼Œæ‰¾ä¸€ç‚¹æ¸©æŸ”çš„å…‰â€", description: "ä½ åœ¨é«˜å¼ºåº¦å·¥ä½œä¸­å¯»æ‰¾â€œå¿ƒçš„å‡ºå£â€ã€‚å¸Œæœ›é€šè¿‡å‚ä¸å…¬ç›Šï¼Œè®©è‡ªå·±ä¸å†è¢«ç–²æƒ«å¡«æ»¡ï¼Œç”¨è¡ŒåŠ¨æ‰¾å›åˆå¿ƒï¼ŒåŒæ—¶ä¸åŒæ ·çœŸè¯šçš„äººå»ºç«‹è¿æ¥ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€æ®µæ¸©æš–æœ‰åŠ›é‡çš„è®°å¿†ï¼Œä¸€ç¾¤èƒ½æ·±å¤œèŠäººç”Ÿçš„ä¼™ä¼´ï¼Œä¸€æ¬¡é‡æ–°ä¸å†…å¿ƒå¯¹è¯çš„æ—…ç¨‹ã€‚ä½ ä¼šå‘ç°ï¼Œå…¬ç›Šä¸ä»…æ˜¯åœ¨å¸®åŠ©åˆ«äººï¼Œä¹Ÿæ˜¯åœ¨æ²»æ„ˆè‡ªå·±ã€‚" },
        R_5: { title: "å…¬ç›ŠåŠ¡å®æ±‚å˜è€…", image: "r5.jpg", quote: "â€œè·³å‡ºæ¡†æ¡†ï¼Œçœ‹è§æ›´å¤§çš„å…¬ç›Šâ€", description: "ä½ æ·±è€•å…¬ç›Šå¤šå¹´ï¼Œå¸Œæœ›è·³å‡ºå•ä¸€æœºæ„æˆ–å•ä¸ªé¢†åŸŸï¼Œæ¥è§¦æ›´å¤šè®®é¢˜ä¸è§†è§’ã€‚å¸Œæœ›åœ¨ABCè·å¾—æ–°çš„æ–¹æ³•è®ºã€æ–°çš„åˆä½œä¼™ä¼´ï¼Œä»¥åŠå¯¹å…¬ç›Šç”Ÿæ€æ›´æ•´ä½“çš„ç†è§£ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€æ¬¡è·¨é¢†åŸŸçš„æ€æƒ³ç¢°æ’ï¼Œä¸€å¥—å¯è¿ç§»çš„æ–¹æ³•è®ºï¼Œä¸€ç¾¤èƒ½é™ªä½ æ¢ç´¢å…¬ç›Šæ–°å¯èƒ½çš„ä¼™ä¼´ã€‚ä½ ä¼šå‘ç°ï¼Œå…¬ç›Šçš„è¾¹ç•Œï¼Œæ¯”ä½ æƒ³è±¡çš„æ›´å®½å¹¿ã€‚" },
        R_6: { title: "æ„ä¹‰ä¸»ä¹‰è€å°†", image: "r6.jpg", quote: "â€œä¸æ˜¯é‡å¤ï¼Œæ˜¯é‡æ–°åˆ›é€ â€", description: "ä½ æœ‰ä¸°å¯Œçš„å’¨è¯¢æˆ–ä¸“ä¸šç»éªŒï¼Œå¸Œæœ›å°†å•†ä¸šé€»è¾‘ä¸å…¬ç›Šä»·å€¼ç»“åˆèµ·æ¥ã€‚ä¸æ˜¯ä¸ºäº†â€œæ¢ä¸ªåœºæ™¯åšåŒæ ·çš„äº‹æƒ…â€ï¼Œè€Œæ˜¯æƒ³å°è¯•ä¸€äº›ä¸åŒçš„æŒ‘æˆ˜ï¼Œå¸¦å‡ºæ–°çš„å¯èƒ½ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€ä¸ªæ‰“ç ´æƒ¯æ€§çš„æ–°æˆ˜åœºï¼Œä¸€æ¬¡ç”¨ç»éªŒå­µåŒ–åˆ›æ–°çš„æœºä¼šï¼Œä¸€ç¾¤æ„¿æ„é™ªä½ â€œæç‚¹ä¸ä¸€æ ·çš„â€åŒè¡Œè€…ã€‚ä½ ä¼šå‘ç°ï¼Œç»éªŒçš„æœ€é«˜ä»·å€¼ï¼Œæ˜¯åˆ›é€ æ–°çš„å¯èƒ½ã€‚" },
        R_7: { title: "äººç”Ÿå®éªŒæ´¾", image: "r7.jpg", quote: "â€œäººç”Ÿæ˜¯ä¸€åœºå®éªŒï¼Œç­”æ¡ˆåœ¨è·¯ä¸Šâ€", description: "ä½ è¿›å…¥äººç”Ÿçš„æ–°é˜¶æ®µï¼Œæƒ³ç”¨æ–°çš„æ–¹å¼ç†è§£ä¸–ç•Œã€ç†è§£è‡ªå·±ã€‚é€šè¿‡å‚ä¸å…¬ç›Šé¡¹ç›®ï¼Œåœ¨å¸®åŠ©åˆ«äººçš„åŒæ—¶ï¼Œä¹Ÿé‡æ–°æ„å»ºè‡ªå·±çš„ä¸–ç•Œè§‚å’Œäººç”Ÿæ¨¡å‹ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€ç§å…¨æ–°çš„æ€ç»´æ–¹å¼ï¼Œä¸€æ¬¡æ‰“ç ´è¾¹ç•Œçš„å°è¯•ï¼Œä¸€ä¸ªé‡æ–°å®šä¹‰äººç”Ÿçš„å¥‘æœºã€‚ä½ ä¼šå‘ç°ï¼Œäººç”Ÿæ˜¯ä¸€åœºå®éªŒï¼Œè€Œä½ å·²ç»èµ°åœ¨æ¢ç´¢ç­”æ¡ˆçš„è·¯ä¸Šã€‚" }
    };

    let currentStep = 'Q1';
    let historyStack = [];

    const screens = {
        intro: document.getElementById('intro-screen'),
        question: document.getElementById('question-screen'),
        result: document.getElementById('result-screen')
    };

    function startTest() {
        screens.intro.style.display = 'none';
        screens.question.style.display = 'block';
        renderStep('Q1');
    }

    function renderStep(stepId) {
        currentStep = stepId;
        const backBtn = document.getElementById('back-btn');
        backBtn.style.display = historyStack.length > 0 ? 'inline-block' : 'none';

        if (stepId.startsWith('R_')) {
            showResult(stepId);
            return;
        }

        const qData = quizData[stepId];
        document.getElementById('q-text').innerText = qData.text;
        
        const optionsContainer = document.getElementById('q-options');
        optionsContainer.innerHTML = '';
        
        qData.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt.text;
            btn.onclick = () => handleSelection(opt.target);
            optionsContainer.appendChild(btn);
        });
    }

    function handleSelection(targetId) {
        historyStack.push(currentStep);
        renderStep(targetId);
    }

    function goBack() {
        if (historyStack.length > 0) {
            const prevStep = historyStack.pop();
            screens.result.style.display = 'none';
            screens.question.style.display = 'block';
            renderStep(prevStep);
        }
    }

    function showResult(resultId) {
        screens.question.style.display = 'none';
        screens.result.style.display = 'block';
        
        // æ¯æ¬¡å±•ç¤ºæ–°ç»“æœæ—¶ï¼Œé‡ç½® DOM çŠ¶æ€
        document.getElementById('poster-container').style.display = 'block';
        document.getElementById('btn-generate').style.display = 'block';
        document.getElementById('btn-generate').innerText = 'ğŸ“¸ ç”Ÿæˆä¸“å±æµ·æŠ¥';
        document.getElementById('final-image-container').style.display = 'none';
        document.getElementById('btn-generate').disabled = false;
        
        const resData = resultsData[resultId];
        document.getElementById('r-title').innerText = "ä½ å±äºï¼š" + resData.title;
        
        // ä¸º img æ ‡ç­¾æ·»åŠ  crossOrigin="anonymous" æ˜¯åº”å¯¹è·¨åŸŸæ¸²æŸ“å›¾ç‰‡çš„ç¬¬äºŒé“ä¿é™©
        const descHtml = `
            <img id="result-source-img" src="${resData.image}" crossOrigin="anonymous" alt="${resData.title}å¡ç‰Œ" style="width: 100%; max-width: 350px; height: auto; display: block; margin: 0 auto 20px; border-radius: 12px; box-shadow: 0 8px 16px rgba(0,0,0,0.1);">
            
            <div style="font-weight: bold; font-size: 1.1rem; margin-bottom: 12px; color: #0000AA; text-align: center;">
                ${resData.quote}
            </div>
            <div style="margin-bottom: 20px; text-align: justify; line-height: 1.6;">
                ${resData.description}
            </div>
            <div style="font-size: 0.95rem; background: #E6E6FF; padding: 18px; border-radius: 10px; color: #0000AA; border-left: 4px solid #0000AA;">
                ${resData.harvest.replace(/\n/g, '<br>')}
            </div>
            <div style="text-align: center; margin-top: 20px; font-size: 0.8rem; color: #666;">
                æµ‹ä¸€æµ‹ä½ çš„ ABCer ä¸“å±ç”»åƒ
            </div>
        `;
        document.getElementById('r-desc').innerHTML = descHtml;
    }

    // æœºåˆ¶ä¸‰ï¼šCanvas ç»˜å›¾é€»è¾‘
    function generatePoster() {
        const btn = document.getElementById('btn-generate');
        btn.innerText = "â³ æ­£åœ¨ç”Ÿæˆä¸­ï¼Œè¯·ç¨å€™...";
        btn.disabled = true;

        const posterNode = document.getElementById('poster-container');
        const sourceImg = document.getElementById('result-source-img');

        // ç¡®ä¿æºå›¾ç‰‡å·²åŠ è½½å®Œæˆåå†æ‰§è¡Œæ¸²æŸ“ï¼Œé¿å…æˆªå›¾ç©ºç™½
        if (sourceImg.complete) {
            execCanvas();
        } else {
            sourceImg.onload = execCanvas;
        }

        function execCanvas() {
            html2canvas(posterNode, {
                useCORS: true,      // å…è®¸åŠ è½½è·¨åŸŸèµ„æºï¼ˆå¦‚æœä½ å¼•ç”¨çš„å›¾ç‰‡ä¸åœ¨åŒåŸŸï¼‰
                scale: 2,           // æå‡ç”Ÿæˆå›¾ç‰‡çš„åƒç´ å¯†åº¦
                backgroundColor: '#ffffff'
            }).then(canvas => {
                // å°† Canvas è½¬æ¢ä¸º Base64 å›¾ç‰‡æ•°æ®
                const imgData = canvas.toDataURL('image/png');
                
                // å°†æ•°æ®å†™å…¥é™æ€ img æ ‡ç­¾
                document.getElementById('final-poster-img').src = imgData;
                
                // çŠ¶æ€åˆ‡æ¢ï¼šéšè—åŸ DOM ä¸ç”ŸæˆæŒ‰é’®ï¼Œå±•ç¤ºæœ€ç»ˆå›¾ç‰‡
                posterNode.style.display = 'none';
                btn.style.display = 'none';
                document.getElementById('final-image-container').style.display = 'block';
            }).catch(err => {
                console.error("ç”Ÿæˆæµ·æŠ¥å¤±è´¥:", err);
                btn.innerText = "âŒ ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•";
                btn.disabled = false;
            });
        }
    }

    function resetTest() {
        historyStack = [];
        screens.result.style.display = 'none';
        screens.intro.style.display = 'block';
        currentStep = 'Q1';
    }
</script>

</body>
</html>
