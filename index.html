<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABCerä¸“å±MBTIæµ‹è¯•</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #0000AA; /* æ·±è“ /
            --secondary-color: #FFFF00; / é»„è‰² /
            --bg-color: #F0F0FF; / æµ…è“èƒŒæ™¯ */
            --light-blue: #E6E6FF;
        }
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg-color);
            color: var(--primary-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 100%;
        }
        .header { text-align: center; margin-bottom: 20px; }
        .question-text { font-size: 1.2rem; font-weight: bold; margin-bottom: 20px; line-height: 1.5; color: var(--primary-color); }
        .options { display: flex; flex-direction: column; gap: 12px; }
        .option-btn {
            background: var(--light-blue);
            border: 2px solid transparent; padding: 12px 16px; border-radius: 8px;
            cursor: pointer; text-align: left; font-size: 1rem; transition: all 0.2s; color: var(--primary-color);
        }
        .option-btn:hover { background: #D0D0FF; border-color: var(--primary-color); }
        .nav-btn {
            margin-top: 20px; background: transparent; color: #666; border: none;
            cursor: pointer; text-decoration: underline; padding: 0; font-size: 0.9rem; display: none;
        }
        .result-title { color: var(--primary-color); font-size: 1.5rem; text-align: center; margin-bottom: 15px; }
        .restart-btn {
            display: block; width: 100%; background: var(--secondary-color); color: var(--primary-color);
            border: none; padding: 12px; border-radius: 8px; margin-top: 20px; cursor: pointer; font-size: 1rem; text-align: center; font-weight: bold;
        }
        .restart-btn:hover { background-color: #E6E600; }
        .generate-btn {
            display: block; width: 100%; background: var(--primary-color); color: var(--secondary-color);
            border: none; padding: 12px; border-radius: 8px; margin-top: 20px; cursor: pointer; font-size: 1rem; text-align: center; font-weight: bold;
        }
        .generate-btn:hover { background-color: #000088; }
        #poster-container { background: #fff; padding: 20px; border-radius: 12px; margin: -20px; }

        /* =========================================
           CSS çº¯ä»£ç ç»˜å›¾åŒºåŸŸ - 7ç§äººæ ¼å½¢çŠ¶å®šä¹‰
        ========================================= */
        .css-art-container {
            width: 100%;
            max-width: 350px;
            height: 220px;
            margin: 0 auto 25px;
            border-radius: 16px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 20px rgba(0,0,170,0.1);
            background: linear-gradient(135deg, #ffffff 0%, #f0f0ff 100%);
            border: 1px solid #e6e6ff;
        }

        /* é€šç”¨å†…éƒ¨å…ƒç´ æ ·å¼ */
        .art-shape { position: absolute; }

        /* R1: å°è¯•é”‹èŠ’çš„æ–°é²œäºº - ä¸»é¢˜ï¼šåˆå‡çš„å¤ªé˜³ä¸èŒèŠ½ */
        .art-r1 .sun {
            width: 80px; height: 80px; background: var(--secondary-color); border-radius: 50%;
            bottom: 60px; left: 50%; transform: translateX(-50%);
            box-shadow: 0 0 30px var(--secondary-color);
        }
        .art-r1 .horizon {
            width: 100%; height: 60px; background: var(--primary-color); bottom: 0; border-radius: 0 0 16px 16px;
        }
        .art-r1 .sprout {
             width: 20px; height: 40px; background: #4CAF50; bottom: 60px; left: 50%; margin-left: -10px;
             border-radius: 20px 20px 0 0;
        }

        /* R2: ä¸“ä¸šä»·å€¼æ´¾ - ä¸»é¢˜ï¼šç»“æ„åŒ–çš„é’»çŸ³/æ ¸å¿ƒ */
        .art-r2 { display: flex; justify-content: center; align-items: center; }
        .art-r2 .diamond-core {
            width: 120px; height: 120px; background: var(--primary-color);
            transform: rotate(45deg);
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,170,0.4);
        }
        .art-r2 .inner-light {
            width: 60px; height: 60px; background: var(--secondary-color);
            box-shadow: 0 0 20px var(--secondary-color);
        }

        /* R3: ç†æƒ³è¯•æ¢è€… - ä¸»é¢˜ï¼šæ¢ç´¢çš„æ–¹å‘ä¸ç½—ç›˜ */
        .art-r3 { display: flex; justify-content: center; align-items: center; }
        .art-r3 .compass-ring {
            width: 140px; height: 140px; border: 8px solid var(--primary-color); border-radius: 50%;
            position: relative;
        }
        .art-r3 .arrow {
            width: 40px; height: 40px; background: var(--secondary-color);
            position: absolute; top: 50%; left: 50%;
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            transform-origin: center bottom;
        }
        .art-r3 .arrow-n { transform: translate(-50%, -100%) rotate(0deg); }
        .art-r3 .arrow-e { transform: translate(-50%, -100%) rotate(90deg); opacity: 0.6; }
        .art-r3 .arrow-w { transform: translate(-50%, -100%) rotate(-90deg); opacity: 0.6; }

        /* R4: å¿ƒç†é“¾æ¥è¿½å¯»è€… - ä¸»é¢˜ï¼šæ¸©æš–è¿æ¥çš„å¿ƒå½¢ */
        .art-r4 { display: flex; justify-content: center; align-items: center; }
        .art-r4 .heart-shape {
            width: 100px; height: 100px; background: #ff6b6b; opacity: 0.8;
            border-radius: 50%; position: absolute; mix-blend-mode: multiply;
        }
        .art-r4 .c1 { transform: translate(-30px, -20px); }
        .art-r4 .c2 { transform: translate(30px, -20px); background: var(--secondary-color); }
        .art-r4 .connect-line {
            width: 120px; height: 20px; background: var(--primary-color); border-radius: 10px; bottom: 40px;
        }

        /* R5: å…¬ç›ŠåŠ¡å®æ±‚å˜è€… - ä¸»é¢˜ï¼šçªç ´æ¡†æ¶çš„æ–¹å— */
        .art-r5 { display: flex; justify-content: center; align-items: center; perspective: 500px; }
        .art-r5 .cube-container { width: 100px; height: 100px; position: relative; transform-style: preserve-3d; transform: rotateX(-20deg) rotateY(30deg); }
        .art-r5 .face { position: absolute; width: 100px; height: 100px; background: var(--primary-color); opacity: 0.8; border: 2px solid #fff; }
        .art-r5 .front { transform: translateZ(50px); }
        .art-r5 .back { transform: rotateY(180deg) translateZ(50px); background: var(--secondary-color);}
        .art-r5 .break-out {
            width: 40px; height: 140px; background: var(--secondary-color);
            position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%) rotate(-15deg);
            z-index: 10; box-shadow: 0 0 15px var(--secondary-color);
        }

        /* R6: æ„ä¹‰ä¸»ä¹‰è€å°† - ä¸»é¢˜ï¼šå‘ä¸Šå¢é•¿çš„è¶‹åŠ¿/ç¾½ç¿¼ */
        .art-r6 { display: flex; align-items: flex-end; justify-content: center; padding-bottom: 30px; }
        .art-r6 .bar {
            width: 30px; background: var(--primary-color); margin: 0 5px; border-radius: 4px 4px 0 0;
        }
        .art-r6 .b1 { height: 40px; opacity: 0.4; }
        .art-r6 .b2 { height: 70px; opacity: 0.7; }
        .art-r6 .b3 { height: 110px; background: var(--secondary-color); box-shadow: 0 -10px 20px rgba(255,255,0,0.5); }
        .art-r6 .wing-icon {
            position: absolute; top: 30px; right: 30px; width: 60px; height: 60px;
            background: var(--secondary-color); clip-path: path('M10 50 C 20 10, 80 10, 90 50 C 80 30, 20 30, 10 50 Z');
            transform: rotate(-20deg);
        }

        /* R7: äººç”Ÿå®éªŒæ´¾ - ä¸»é¢˜ï¼šæµåŠ¨çš„çƒ§ç“¶ä¸èåˆ */
        .art-r7 { display: flex; justify-content: center; align-items: center; }
        .art-r7 .flask {
            width: 80px; height: 120px; background: #fff; border: 4px solid var(--primary-color);
            border-radius: 40px 40px 60px 60px; position: relative; overflow: hidden;
        }
        .art-r7 .liquid {
            position: absolute; bottom: 0; width: 100%; height: 70%;
            background: linear-gradient(to top, var(--primary-color), var(--secondary-color));
            border-radius: 20% 80% 50% 50% / 40% 60% 40% 60%;
            animation: weave 3s infinite linear;
        }
        @keyframes weave { 0% { transform: translateX(-10%) rotate(0deg); } 100% { transform: translateX(-10%) rotate(360deg); } }

    </style>
</head>
<body>

<div class="container">
    <div id="intro-screen">
        <div class="header">
            <img src="image_0.png" alt="ABC Logo" style="max-width: 150px; margin-bottom: 10px; display: none;"> <div style="font-size: 2rem; margin-bottom: 10px;">ğŸŒŸ</div>
            <h2>ã€ABCerä¸“å±MBTIã€‘</h2>
            <p>7ç§ABCerï¼Œä½ æ˜¯å“ªä¸€ç§ï¼Ÿ</p>
        </div>
        <p style="color: #666; font-size: 0.95rem; line-height: 1.5;">å˜¿ï¼æ¥ABCç¾å¥½ç¤¾ä¼šå’¨è¯¢ç¤¾çš„å°ä¼™ä¼´ä»¬ï¼Œæ¯ä¸ªäººéƒ½å¸¦ç€ä¸åŒçš„æ•…äº‹å’ŒæœŸå¾…ï½ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸ºä½ é‡èº«å®šåˆ¶äº†ä¸€å¥—ä¸“å±äººæ ¼æµ‹è¯•ï¼10é“é¢˜ï¼Œæµ‹å‡ºä½ åœ¨å…¬ç›Šå’¨è¯¢ä¸­çš„çœŸå®ç”»åƒã€‚</p>
        <button class="restart-btn" onclick="startTest()">å¼€å§‹æµ‹è¯•</button>
    </div>

    <div id="question-screen" style="display: none;">
        <div class="question-text" id="q-text"></div>
        <div class="options" id="q-options"></div>
        <button class="nav-btn" id="back-btn" onclick="goBack()">â† è¿”å›ä¸Šä¸€é¢˜</button>
    </div>

    <div id="result-screen" style="display: none;">
        <div id="poster-container">
            <h2 class="result-title" id="r-title"></h2>

            <div id="art-render-target"></div>

            <div class="result-desc" id="r-desc"></div>
        </div>

        <div id="final-image-container" style="display: none; text-align: center;">
            <p style="color: var(--primary-color); font-weight: bold; margin-bottom: 15px;">â¬‡ï¸ é•¿æŒ‰ä¸‹æ–¹å›¾ç‰‡ä¿å­˜å¹¶åˆ†äº« â¬‡ï¸</p>
            <img id="final-poster-img" style="width: 100%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);" />
        </div>

        <button id="btn-generate" class="generate-btn" onclick="generatePoster()">ğŸ“¸ ç”Ÿæˆä¸“å±æµ·æŠ¥</button>
        <button class="restart-btn" onclick="resetTest()">é‡æ–°æµ‹è¯•</button>
    </div>
</div>

<script>
    // é—®å·é€»è¾‘æ•°æ®æ¨¡å‹ (ä¿æŒä¸å˜)
    const quizData = {
        Q1: { text: "Q1. éš¾å¾—çš„å‘¨æœ«ç©ºé—²ï¼Œä½ æœ€æƒ³æ€ä¹ˆåº¦è¿‡ï¼Ÿ", options: [{text:"A. çº¦æœ‹å‹æ¢åº—çœ‹å±•ï¼Œè§£é”æ–°ä½“éªŒ",target:"Q2"},{text:"B. å‚åŠ è¡Œä¸šæ²™é¾™ï¼Œå¬å¬å‰æ²¿åˆ†äº«",target:"Q3"},{text:"C. æ‰¾ä¸ªå’–å•¡é¦†ï¼Œå®‰å®‰é™é™çœ‹ä¹¦",target:"Q4"},{text:"D. çº¦ä¸‰äº”å¥½å‹ï¼ŒèŠèŠè¿‘å†µå’Œå¿ƒäº‹",target:"Q5"}] },
        Q2: { text: "Q2. ä½ æ›´å‘å¾€å“ªç§å›¢é˜Ÿæ°›å›´ï¼Ÿ", options: [{text:"A. æœ‰å‰è¾ˆå¸¦ç€ï¼Œèƒ½å­¦åˆ°å¾ˆå¤šä¸œè¥¿",target:"R_1"},{text:"B. å¤§å®¶å„æœ‰æ‰€é•¿ï¼Œé«˜æ•ˆåä½œæ‰“ç¡¬ä»—",target:"Q6"},{text:"C. æ¸©æš–åŒ…å®¹ï¼Œå¯ä»¥å¸ä¸‹é˜²å¤‡åšè‡ªå·±",target:"Q7"},{text:"D. å¼€æ”¾è‡ªç”±ï¼Œå…è®¸å¤©é©¬è¡Œç©ºçš„è„‘æ´",target:"Q8"}] },
        Q3: { text: "Q3. ä½ å¯¹â€œå…¬ç›Šâ€çš„ç¬¬ä¸€å°è±¡æ˜¯ï¼Ÿ", options: [{text:"A. ä¸€ä¸ªèƒ½è®©ä¸“ä¸šå‘æŒ¥æ›´å¤§ä»·å€¼çš„åœ°æ–¹",target:"R_2"},{text:"B. ä¸€ä¸ªå¯ä»¥æ·±å…¥äº†è§£å…¬ç›Šç”Ÿæ€çš„æœºä¼š",target:"Q6"},{text:"C. ä¸€ä¸ªèƒ½è®©å¿ƒæ…¢ä¸‹æ¥ã€æš–èµ·æ¥çš„åœ°æ–¹",target:"Q7"},{text:"D. ä¸€ä¸ªå¯ä»¥æ¢ç´¢äººç”Ÿæ–°å¯èƒ½çš„å®éªŒåœº",target:"Q8"}] },
        Q4: { text: "Q4. ä½ æœ€è¿‘çš„çŠ¶æ€ï¼Œæ›´åƒå“ªä¸€å¥ï¼Ÿ", options: [{text:"A. ä¸–ç•Œé‚£ä¹ˆå¤§ï¼Œæˆ‘æƒ³å»è¯•è¯•",target:"R_3"},{text:"B. ç”¨ä¸“ä¸šï¼Œåšç‚¹æœ‰æ„ä¹‰çš„äº‹",target:"Q6"},{text:"C. åœ¨ç–²æƒ«çš„ç”Ÿæ´»é‡Œï¼Œæ‰¾ä¸€ç‚¹æ¸©æŸ”çš„å…‰",target:"Q7"},{text:"D. äººç”Ÿæ˜¯ä¸€åœºå®éªŒï¼Œç­”æ¡ˆåœ¨è·¯ä¸Š",target:"Q8"}] },
        Q5: { text: "Q5. ä½ æ›´æ„¿æ„å’Œä»€ä¹ˆæ ·çš„ä¼™ä¼´å…±äº‹ï¼Ÿ", options: [{text:"A. æ„¿æ„æ•™æˆ‘ã€å¸¦æˆ‘æˆé•¿çš„äºº",target:"R_1"},{text:"B. ä¸“ä¸šèƒ½åŠ›å¼ºã€èƒ½æ‰“ç¡¬ä»—çš„äºº",target:"Q6"},{text:"C. çœŸè¯šæ¸©æš–ã€å¯ä»¥äº¤å¿ƒçš„äºº",target:"R_4"},{text:"D. è„‘æ´å¤§ã€æ•¢æƒ³æ•¢è¯•çš„äºº",target:"Q8"}] },
        Q6: { text: "Q6. ä½ å¸Œæœ›ç”¨ä¸“ä¸šç»éªŒåœ¨å…¬ç›Šé¢†åŸŸåšä»€ä¹ˆï¼Ÿ", options: [{text:"A. æŠŠæŠ€èƒ½ç”¨åœ¨æ›´çœŸå®ã€æœ‰æ„ä¹‰çš„åœºæ™¯",target:"R_2"},{text:"B. è·³å‡ºå•ä¸€é¢†åŸŸï¼Œçœ‹è§æ›´å¤§çš„å…¬ç›Šç”Ÿæ€",target:"R_5"},{text:"C. å¸¦å›¢é˜Ÿè¯•è¯•ä¸ä¸€æ ·çš„è·¯ï¼Œç©ç‚¹æ–°çš„",target:"R_6"},{text:"D. æ—¢æƒ³è´¡çŒ®ä»·å€¼ï¼Œä¹Ÿæƒ³æ‰¾åˆ°å¹¶è‚©çš„ä¼™ä¼´",target:"Q9"}] },
        Q7: { text: "Q7. ä½ å¯»æ‰¾çš„â€œå¿ƒçš„å‡ºå£â€ï¼Œæ›´åƒå“ªä¸€ç§ï¼Ÿ", options: [{text:"A. ç”¨è¡ŒåŠ¨æ‰¾å›åˆå¿ƒï¼Œä¸å†è¢«ç–²æƒ«å¡«æ»¡",target:"R_4"},{text:"B. å’ŒçœŸè¯šçš„äººå»ºç«‹è¿æ¥ï¼Œäº’ç›¸æ¸©æš–",target:"R_4"},{text:"C. åœ¨å¸®åŠ©åˆ«äººçš„åŒæ—¶ï¼Œé‡æ–°è®¤è¯†è‡ªå·±",target:"Q10"},{text:"D. æƒ³ç”¨æ–°æ–¹å¼ç†è§£ä¸–ç•Œå’Œè‡ªå·±",target:"R_7"}] },
        Q8: { text: "Q8. ä½ æƒ³å°è¯•çš„â€œæ–°å¯èƒ½â€ï¼Œæ›´æ¥è¿‘ï¼Ÿ", options: [{text:"A. æŠŠå…´è¶£ã€ä¸“ä¸šå’Œç¤¾ä¼šè®®é¢˜è¿æ¥èµ·æ¥",target:"R_3"},{text:"B. ç”¨ç»éªŒå­µåŒ–åˆ›æ–°ï¼Œå¸¦å‡ºæ–°çš„å¯èƒ½",target:"R_6"},{text:"C. é‡æ–°æ„å»ºè‡ªå·±çš„ä¸–ç•Œè§‚å’Œäººç”Ÿæ¨¡å‹",target:"R_7"},{text:"D. éªŒè¯â€œæˆ‘é€‚ä¸é€‚åˆåšè¿™ç±»äº‹â€",target:"R_3"}] },
        Q9: { text: "Q9. ä½ å¸Œæœ›ä»ABCå¸¦èµ°çš„æ˜¯ä»€ä¹ˆï¼Ÿ", options: [{text:"A. ä¸€ä¸ªæœ‰å½±å“åŠ›çš„å®æˆ˜æ¡ˆä¾‹",target:"R_2"},{text:"B. å¯¹å…¬ç›Šç”Ÿæ€æ›´æ•´ä½“çš„ç†è§£",target:"R_5"},{text:"C. ä¸€æ¬¡ç”¨ç»éªŒåˆ›é€ æ–°å¯èƒ½çš„å°è¯•",target:"R_6"},{text:"D. ä¸€ç¾¤å¿—åŒé“åˆçš„æˆ˜å‹",target:"R_2"}] },
        Q10: { text: "Q10. ä½ æœŸå¾…åœ¨å…¬ç›Šä¸­é‡è§ä»€ä¹ˆï¼Ÿ", options: [{text:"A. ä¸€æ®µæ¸©æš–æœ‰åŠ›é‡çš„è®°å¿†",target:"R_4"},{text:"B. ä¸€æ¬¡é‡æ–°ä¸å†…å¿ƒå¯¹è¯çš„æ—…ç¨‹",target:"R_4"},{text:"C. ä¸€ç§å…¨æ–°çš„æ€ç»´æ–¹å¼",target:"R_7"},{text:"D. ä¸€ä¸ªé‡æ–°å®šä¹‰äººç”Ÿçš„å¥‘æœº",target:"R_7"}] }
    };

    // ç»“æœåº“æ•°æ® (ç§»é™¤ image å­—æ®µï¼Œæ–°å¢ artClass å­—æ®µç”¨äº CSS ç»˜å›¾)
    const resultsData = {
        R_1: { title: "å°è¯•é”‹èŠ’çš„æ–°é²œäºº", artClass: "art-r1", quote: "â€œä¸–ç•Œé‚£ä¹ˆå¤§ï¼Œæˆ‘æƒ³å»è¯•è¯•â€", description: "ä½ æ˜¯å¸¦ç€å¥½å¥‡å¿ƒå’Œå‹‡æ°”è¸å…¥å…¬ç›Šå’¨è¯¢ä¸–ç•Œçš„â€œå®è·µæ´¾ç©å®¶â€ã€‚åœ¨æ ¡å›­é‡Œç§¯ç´¯äº†çŸ¥è¯†ï¼Œæƒ³åœ¨çœŸå®ä¸–ç•Œé‡Œè·‘ä¸€æ¬¡â€œå‰¯æœ¬â€ã€‚ä½ æ¸´æœ›ç»“è¯†æœ‰è¶£çš„äººï¼Œç§¯ç´¯ç¬¬ä¸€ä»½é¡¹ç›®ç»éªŒï¼Œè¯•ç€æŠŠå…´è¶£ã€ä¸“ä¸šå’Œç¤¾ä¼šè®®é¢˜è¿æ¥èµ·æ¥ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€ä»½æ‰å®çš„é¡¹ç›®ç»å†ï¼Œä¸€ç¾¤æ„¿æ„å¸¦ä½ çš„å‰è¾ˆï¼Œä¸€æ¬¡æŠŠå¥½å¥‡å¿ƒå˜æˆè¡ŒåŠ¨åŠ›çš„æœºä¼šã€‚ä½ ä¼šå‘ç°ï¼Œä¸–ç•Œå¾ˆå¤§ï¼Œè€Œä½ ä¹Ÿå¯ä»¥æˆä¸ºæ”¹å˜çš„ä¸€éƒ¨åˆ†ã€‚" },
        R_2: { title: "ä¸“ä¸šä»·å€¼æ´¾", artClass: "art-r2", quote: "â€œç”¨ä¸“ä¸šï¼Œåšç‚¹æœ‰æ„ä¹‰çš„äº‹â€", description: "ä½ æ‹¥æœ‰è¾ƒå¼ºçš„ä¸“ä¸šèƒŒæ™¯ï¼ŒæœŸå¾…æŠŠè‡ªå·±çš„æŠ€èƒ½ç”¨äºæ›´çœŸå®ã€æ›´æœ‰æ„ä¹‰çš„åœºæ™¯ã€‚åœ¨é¡¹ç›®ä¸­å¸Œæœ›æ—¢èƒ½è´¡çŒ®ä»·å€¼ï¼Œä¹Ÿèƒ½æ‰¾åˆ°èƒ½å¤Ÿå¹¶è‚©ä½œæˆ˜çš„ä¼™ä¼´ï¼Œä¸€èµ·æŠŠäº‹æƒ…åšæˆã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€ä¸ªæœ‰å½±å“åŠ›çš„æ¡ˆä¾‹ï¼Œä¸€ç¾¤å¿—åŒé“åˆçš„æˆ˜å‹ï¼Œä¸€æ¬¡ä¸“ä¸šä¸å…¬ç›Šæ·±åº¦èåˆçš„å®è·µã€‚ä½ ä¼šå‘ç°ï¼Œä½ çš„æŠ€èƒ½å¯ä»¥ç‚¹äº®åˆ«äººï¼Œä¹Ÿå¯ä»¥ç…§äº®è‡ªå·±ã€‚" },
        R_3: { title: "ç†æƒ³è¯•æ¢è€…", artClass: "art-r3", quote: "â€œæˆ‘æƒ³çœ‹çœ‹ï¼Œæˆ‘é€‚ä¸é€‚åˆâ€", description: "ä½ åˆšè¸å…¥èŒåœºï¼Œæ¸´æœ›æ¢ç´¢æ›´å¤šå¯èƒ½æ€§ã€‚å¯¹å…¬å…±è®®é¢˜æœ‰å…´è¶£ï¼Œå´è¿˜ä¸ç¡®å®šæ–¹å‘ã€‚å¸Œæœ›é€šè¿‡ä¸€æ¬¡å…¬ç›Šå’¨è¯¢ï¼Œç§¯ç´¯æ¡ˆä¾‹ã€å¢å¼ºèŒä¸šæ„ŸçŸ¥ï¼Œä¹ŸéªŒè¯â€œæˆ‘é€‚ä¸é€‚åˆåšè¿™ç±»äº‹â€ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€æ¬¡ä½æˆæœ¬çš„èŒä¸šè¯•é”™æœºä¼šï¼Œä¸€ä¸ªéªŒè¯å…´è¶£ä¸èƒ½åŠ›çš„çœŸå®åœºæ™¯ï¼Œä¸€ç¾¤å¸®ä½ æ‰“å¼€è§†é‡çš„åŒè¡Œè€…ã€‚ä½ ä¼šå‘ç°ï¼Œç­”æ¡ˆä¸åœ¨åˆ«å¤„ï¼Œå°±åœ¨è¡ŒåŠ¨çš„è·¯ä¸Šã€‚" },
        R_4: { title: "å¿ƒç†é“¾æ¥è¿½å¯»è€…", artClass: "art-r4", quote: "â€œåœ¨ç–²æƒ«çš„ç”Ÿæ´»é‡Œï¼Œæ‰¾ä¸€ç‚¹æ¸©æŸ”çš„å…‰â€", description: "ä½ åœ¨é«˜å¼ºåº¦å·¥ä½œä¸­å¯»æ‰¾â€œå¿ƒçš„å‡ºå£â€ã€‚å¸Œæœ›é€šè¿‡å‚ä¸å…¬ç›Šï¼Œè®©è‡ªå·±ä¸å†è¢«ç–²æƒ«å¡«æ»¡ï¼Œç”¨è¡ŒåŠ¨æ‰¾å›åˆå¿ƒï¼ŒåŒæ—¶ä¸åŒæ ·çœŸè¯šçš„äººå»ºç«‹è¿æ¥ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€æ®µæ¸©æš–æœ‰åŠ›é‡çš„è®°å¿†ï¼Œä¸€ç¾¤èƒ½æ·±å¤œèŠäººç”Ÿçš„ä¼™ä¼´ï¼Œä¸€æ¬¡é‡æ–°ä¸å†…å¿ƒå¯¹è¯çš„æ—…ç¨‹ã€‚ä½ ä¼šå‘ç°ï¼Œå…¬ç›Šä¸ä»…æ˜¯åœ¨å¸®åŠ©åˆ«äººï¼Œä¹Ÿæ˜¯åœ¨æ²»æ„ˆè‡ªå·±ã€‚" },
        R_5: { title: "å…¬ç›ŠåŠ¡å®æ±‚å˜è€…", artClass: "art-r5", quote: "â€œè·³å‡ºæ¡†æ¡†ï¼Œçœ‹è§æ›´å¤§çš„å…¬ç›Šâ€", description: "ä½ æ·±è€•å…¬ç›Šå¤šå¹´ï¼Œå¸Œæœ›è·³å‡ºå•ä¸€æœºæ„æˆ–å•ä¸ªé¢†åŸŸï¼Œæ¥è§¦æ›´å¤šè®®é¢˜ä¸è§†è§’ã€‚å¸Œæœ›åœ¨ABCè·å¾—æ–°çš„æ–¹æ³•è®ºã€æ–°çš„åˆä½œä¼™ä¼´ï¼Œä»¥åŠå¯¹å…¬ç›Šç”Ÿæ€æ›´æ•´ä½“çš„ç†è§£ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€æ¬¡è·¨é¢†åŸŸçš„æ€æƒ³ç¢°æ’ï¼Œä¸€å¥—å¯è¿ç§»çš„æ–¹æ³•è®ºï¼Œä¸€ç¾¤èƒ½é™ªä½ æ¢ç´¢å…¬ç›Šæ–°å¯èƒ½çš„ä¼™ä¼´ã€‚ä½ ä¼šå‘ç°ï¼Œå…¬ç›Šçš„è¾¹ç•Œï¼Œæ¯”ä½ æƒ³è±¡çš„æ›´å®½å¹¿ã€‚" },
        R_6: { title: "æ„ä¹‰ä¸»ä¹‰è€å°†", artClass: "art-r6", quote: "â€œä¸æ˜¯é‡å¤ï¼Œæ˜¯é‡æ–°åˆ›é€ â€", description: "ä½ æœ‰ä¸°å¯Œçš„å’¨è¯¢æˆ–ä¸“ä¸šç»éªŒï¼Œå¸Œæœ›å°†å•†ä¸šé€»è¾‘ä¸å…¬ç›Šä»·å€¼ç»“åˆèµ·æ¥ã€‚ä¸æ˜¯ä¸ºäº†â€œæ¢ä¸ªåœºæ™¯åšåŒæ ·çš„äº‹æƒ…â€ï¼Œè€Œæ˜¯æƒ³å°è¯•ä¸€äº›ä¸åŒçš„æŒ‘æˆ˜ï¼Œå¸¦å‡ºæ–°çš„å¯èƒ½ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€ä¸ªæ‰“ç ´æƒ¯æ€§çš„æ–°æˆ˜åœºï¼Œä¸€æ¬¡ç”¨ç»éªŒå­µåŒ–åˆ›æ–°çš„æœºä¼šï¼Œä¸€ç¾¤æ„¿æ„é™ªä½ â€œæç‚¹ä¸ä¸€æ ·çš„â€åŒè¡Œè€…ã€‚ä½ ä¼šå‘ç°ï¼Œç»éªŒçš„æœ€é«˜ä»·å€¼ï¼Œæ˜¯åˆ›é€ æ–°çš„å¯èƒ½ã€‚" },
        R_7: { title: "äººç”Ÿå®éªŒæ´¾", artClass: "art-r7", quote: "â€œäººç”Ÿæ˜¯ä¸€åœºå®éªŒï¼Œç­”æ¡ˆåœ¨è·¯ä¸Šâ€", description: "ä½ è¿›å…¥äººç”Ÿçš„æ–°é˜¶æ®µï¼Œæƒ³ç”¨æ–°çš„æ–¹å¼ç†è§£ä¸–ç•Œã€ç†è§£è‡ªå·±ã€‚é€šè¿‡å‚ä¸å…¬ç›Šé¡¹ç›®ï¼Œåœ¨å¸®åŠ©åˆ«äººçš„åŒæ—¶ï¼Œä¹Ÿé‡æ–°æ„å»ºè‡ªå·±çš„ä¸–ç•Œè§‚å’Œäººç”Ÿæ¨¡å‹ã€‚", harvest: "ğŸ”® ä½ åœ¨ABCèƒ½æ”¶è·ä»€ä¹ˆï¼š\nä¸€ç§å…¨æ–°çš„æ€ç»´æ–¹å¼ï¼Œä¸€æ¬¡æ‰“ç ´è¾¹ç•Œçš„å°è¯•ï¼Œä¸€ä¸ªé‡æ–°å®šä¹‰äººç”Ÿçš„å¥‘æœºã€‚ä½ ä¼šå‘ç°ï¼Œäººç”Ÿæ˜¯ä¸€åœºå®éªŒï¼Œè€Œä½ å·²ç»èµ°åœ¨æ¢ç´¢ç­”æ¡ˆçš„è·¯ä¸Šã€‚" }
    };

    let currentStep = 'Q1';
    let historyStack = [];

    const screens = {
        intro: document.getElementById('intro-screen'),
        question: document.getElementById('question-screen'),
        result: document.getElementById('result-screen')
    };

    function startTest() {
        screens.intro.style.display = 'none';
        screens.question.style.display = 'block';
        renderStep('Q1');
    }

    function renderStep(stepId) {
        currentStep = stepId;
        const backBtn = document.getElementById('back-btn');
        backBtn.style.display = historyStack.length > 0 ? 'inline-block' : 'none';

        if (stepId.startsWith('R_')) {
            showResult(stepId);
            return;
        }

        const qData = quizData[stepId];
        document.getElementById('q-text').innerText = qData.text;

        const optionsContainer = document.getElementById('q-options');
        optionsContainer.innerHTML = '';

        qData.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt.text;
            btn.onclick = () => handleSelection(opt.target);
            optionsContainer.appendChild(btn);
        });
    }

    function handleSelection(targetId) {
        historyStack.push(currentStep);
        renderStep(targetId);
    }

    function goBack() {
        if (historyStack.length > 0) {
            const prevStep = historyStack.pop();
            screens.result.style.display = 'none';
            screens.question.style.display = 'block';
            renderStep(prevStep);
        }
    }

    function showResult(resultId) {
        screens.question.style.display = 'none';
        screens.result.style.display = 'block';

        // é‡ç½® DOM çŠ¶æ€
        document.getElementById('poster-container').style.display = 'block';
        document.getElementById('btn-generate').style.display = 'block';
        document.getElementById('btn-generate').innerText = 'ğŸ“¸ ç”Ÿæˆä¸“å±æµ·æŠ¥';
        document.getElementById('final-image-container').style.display = 'none';
        document.getElementById('btn-generate').disabled = false;

        const resData = resultsData[resultId];
        document.getElementById('r-title').innerText = "ä½ å±äºï¼š" + resData.title;

        // æ¸²æŸ“ CSS ç»˜å›¾
        const artContainer = document.getElementById('art-render-target');
        artContainer.className = 'css-art-container ' + resData.artClass;
        // æ ¹æ®ä¸åŒçš„ Art Class æ’å…¥å¿…è¦çš„å†…éƒ¨ DOM ç»“æ„ä»¥è¾…åŠ© CSS ç»˜å›¾
        let innerArtHTML = '';
        switch(resData.artClass) {
            case 'art-r1': innerArtHTML = '<div class="art-shape sun"></div><div class="art-shape sprout"></div><div class="art-shape horizon"></div>'; break;
            case 'art-r2': innerArtHTML = '<div class="art-shape diamond-core"><div class="art-shape inner-light"></div></div>'; break;
            case 'art-r3': innerArtHTML = '<div class="art-shape compass-ring"><div class="art-shape arrow arrow-n"></div><div class="art-shape arrow arrow-e"></div></div>'; break;
            case 'art-r4': innerArtHTML = '<div class="art-shape heart-shape c1"></div><div class="art-shape heart-shape c2"></div><div class="art-shape connect-line"></div>'; break;
            case 'art-r5': innerArtHTML = '<div class="art-shape cube-container"><div class="face front"></div><div class="face back"></div></div><div class="art-shape break-out"></div>'; break;
            case 'art-r6': innerArtHTML = '<div class="art-shape bar b1"></div><div class="art-shape bar b2"></div><div class="art-shape bar b3"></div><div class="art-shape wing-icon"></div>'; break;
            case 'art-r7': innerArtHTML = '<div class="art-shape flask"><div class="liquid"></div></div>'; break;
        }
        artContainer.innerHTML = innerArtHTML;


        // æ¸²æŸ“æ–‡æœ¬
        const descHtml =             <div style="font-weight: bold; font-size: 1.1rem; margin-bottom: 12px; color: var(--primary-color); text-align: center;">                 ${resData.quote}             </div>             <div style="margin-bottom: 20px; text-align: justify; line-height: 1.6;">                 ${resData.description}             </div>             <div style="font-size: 0.95rem; background: var(--light-blue); padding: 18px; border-radius: 10px; color: var(--primary-color); border-left: 4px solid var(--primary-color);">                 ${resData.harvest.replace(/\n/g, '<br>')}             </div>             <div style="text-align: center; margin-top: 20px; font-size: 0.8rem; color: #666;">                 æµ‹ä¸€æµ‹ä½ çš„ ABCer ä¸“å±ç”»åƒ             </div>        ;
        document.getElementById('r-desc').innerHTML = descHtml;
    }

    // æœºåˆ¶ä¸‰ï¼šCanvas ç»˜å›¾é€»è¾‘ (ç”±äºæ˜¯çº¯ CSSï¼Œæ²¡æœ‰è·¨åŸŸé—®é¢˜ï¼Œç¨³å®šæ€§æ›´é«˜)
    function generatePoster() {
        const btn = document.getElementById('btn-generate');
        btn.innerText = "â³ æ­£åœ¨ç”Ÿæˆä¸­ï¼Œè¯·ç¨å€™...";
        btn.disabled = true;

        const posterNode = document.getElementById('poster-container');

        html2canvas(posterNode, {
            scale: 2,
            backgroundColor: '#F0F0FF', // è®¾ç½®æµ·æŠ¥èƒŒæ™¯è‰²ä¸ç½‘é¡µä¸€è‡´
            logging: false
        }).then(canvas => {
            const imgData = canvas.toDataURL('image/png');
            document.getElementById('final-poster-img').src = imgData;
            posterNode.style.display = 'none';
            btn.style.display = 'none';
            document.getElementById('final-image-container').style.display = 'block';
        }).catch(err => {
            console.error("ç”Ÿæˆæµ·æŠ¥å¤±è´¥:", err);
            btn.innerText = "âŒ ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•";
            btn.disabled = false;
        });
    }

    function resetTest() {
        historyStack = [];
        screens.result.style.display = 'none';
        screens.intro.style.display = 'block';
        currentStep = 'Q1';
    }
</script>

</body>
</html>
